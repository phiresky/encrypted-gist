{"version":3,"sources":["../src/base64.ts","../src/main.ts"],"names":["base64","GithubRepo","GithubRepo.constructor","GithubRepo.fetch","GithubRepo.fetchJSON","GithubRepo.fetchRaw","GithubRepo.postJSON","GithubRepo.getRefs","GithubRepo.getRef","GithubRepo.updateRef","GithubRepo.getHead","GithubRepo.getTree","GithubRepo.createBlob","GithubRepo.getBlob","GithubRepo.createTree","GithubRepo.createCommit","GithubRepo.pushFileToMaster","getAllowUploadURL","encrypt","decrypt","uploadEncrypted","displayImage","download","hexToArr","arrToHex","uploadFile","readFile"],"mappings":"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","file":"tmp.js","sourcesContent":[null,"var base64;\n(function (base64_1) {\n    base64_1._chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    base64_1.encode = function (arraybuffer, url = false, equals = true) {\n        let chars = base64_1._chars;\n        if (url)\n            chars = chars.substr(0, 62) + '-_';\n        var bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = \"\";\n        for (i = 0; i < len; i += 3) {\n            base64 += chars[bytes[i] >> 2];\n            base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n            base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n            base64 += chars[bytes[i + 2] & 63];\n        }\n        if ((len % 3) === 2) {\n            base64 = base64.substring(0, base64.length - 1) + (equals ? \"=\" : \"\");\n        }\n        else if (len % 3 === 1) {\n            base64 = base64.substring(0, base64.length - 2) + (equals ? \"==\" : \"\");\n        }\n        return base64;\n    };\n    base64_1.decode = function (base64, url = false) {\n        let chars = base64_1._chars;\n        if (url)\n            chars = chars.substr(0, 62) + '-_';\n        var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n        if (base64[base64.length - 1] === \"=\") {\n            bufferLength--;\n            if (base64[base64.length - 2] === \"=\") {\n                bufferLength--;\n            }\n        }\n        var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n        for (i = 0; i < len; i += 4) {\n            encoded1 = chars.indexOf(base64[i]);\n            encoded2 = chars.indexOf(base64[i + 1]);\n            encoded3 = chars.indexOf(base64[i + 2]);\n            encoded4 = chars.indexOf(base64[i + 3]);\n            bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n            bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n            bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n        }\n        return arraybuffer;\n    };\n})(base64 || (base64 = {}));\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, Promise, generator) {\n    return new Promise(function (resolve, reject) {\n        generator = generator.call(thisArg, _arguments);\n        function cast(value) { return value instanceof Promise && value.constructor === Promise ? value : new Promise(function (resolve) { resolve(value); }); }\n        function onfulfill(value) { try { step(\"next\", value); } catch (e) { reject(e); } }\n        function onreject(value) { try { step(\"throw\", value); } catch (e) { reject(e); } }\n        function step(verb, value) {\n            var result = generator[verb](value);\n            result.done ? resolve(result.value) : cast(result.value).then(onfulfill, onreject);\n        }\n        step(\"next\", void 0);\n    });\n};\nconst repoName = \"phire-store/testing\";\nconst branch = 'master';\nclass GithubRepo {\n    constructor(repo, access_token = null) {\n        this.access_token = access_token;\n        this.apiUrl = \"\";\n        this.apiUrl = `https://api.github.com/repos/${repo}`;\n    }\n    fetch(path, data) {\n        return __awaiter(this, void 0, Promise, function* () {\n            if (!data)\n                data = { headers: new Headers() };\n            const h = data.headers;\n            if (this.access_token)\n                h.append(\"Authorization\", \"token \" + this.access_token);\n            console.log(data);\n            return yield fetch(this.apiUrl + path, data);\n        });\n    }\n    fetchJSON(path, data) {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield (yield this.fetch(path, data)).json();\n        });\n    }\n    fetchRaw(path, data) {\n        return __awaiter(this, void 0, Promise, function* () {\n            const headers = new Headers();\n            headers.append(\"Accept\", \"application/vnd.github.v3.raw\");\n            const r = yield this.fetch(path, { headers });\n            return yield r.arrayBuffer();\n        });\n    }\n    postJSON(path, data, method = \"POST\") {\n        return __awaiter(this, void 0, Promise, function* () {\n            const headers = new Headers();\n            headers.append(\"Content-Type\", \"application/json;charset=UTF-8\");\n            return yield this.fetchJSON(path, {\n                method,\n                headers,\n                body: JSON.stringify(data)\n            });\n        });\n    }\n    getRefs() {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield this.fetchJSON(\"/git/refs\");\n        });\n    }\n    getRef(ref = \"heads/master\") {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield this.fetchJSON(\"/git/refs/\" + ref);\n        });\n    }\n    updateRef(sha, ref = \"heads/master\") {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield this.postJSON(\"/git/refs/\" + ref, { sha }, \"PATCH\");\n        });\n    }\n    getHead() {\n        return __awaiter(this, void 0, Promise, function* () {\n            const branch = yield this.getRef();\n            return branch.object.sha;\n        });\n    }\n    getTree(sha, recursive = false) {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield this.fetchJSON(\"/git/trees/\" + sha + (recursive ? \"?recursive=1\" : \"\"));\n        });\n    }\n    createBlob(data) {\n        return __awaiter(this, void 0, Promise, function* () {\n            const resp = yield this.postJSON(\"/git/blobs\", {\n                encoding: \"base64\",\n                content: base64.encode(data)\n            });\n            return resp.sha;\n        });\n    }\n    getBlob(sha) {\n        return __awaiter(this, void 0, Promise, function* () {\n            return yield this.fetchRaw(\"/git/blobs/\" + sha);\n        });\n    }\n    createTree(base_tree, path, sha) {\n        return __awaiter(this, void 0, Promise, function* () {\n            const resp = yield this.postJSON(\"/git/trees\", {\n                base_tree,\n                tree: [\n                    { path, mode: \"100644\", type: \"blob\", sha }\n                ]\n            });\n            return resp;\n        });\n    }\n    createCommit(parent, tree, message) {\n        return __awaiter(this, void 0, Promise, function* () {\n            const resp = yield this.postJSON(\"/git/commits\", {\n                message,\n                parents: [parent],\n                tree,\n            });\n            return resp;\n        });\n    }\n    pushFileToMaster(path, content) {\n        return __awaiter(this, void 0, Promise, function* () {\n            const head = yield this.getHead();\n            const newtree = yield this.createTree(head, path, yield this.createBlob(content.buffer));\n            const newsha = newtree.sha;\n            const files = newtree.tree;\n            const filesha = files.filter(file => file.path == path)[0].sha;\n            const commit = yield this.createCommit(head, newsha, \"testiiing\");\n            yield this.updateRef(commit.sha);\n            return filesha;\n        });\n    }\n}\nlet repo = new GithubRepo(repoName, localStorage.getItem(\"accessToken\"));\nfunction getAllowUploadURL() {\n    return __awaiter(this, void 0, Promise, function* () {\n        const info = yield encrypt(hexToArr(repo.access_token));\n        location.hash = \"#allowupload!\" + base64.encode(info.data.buffer, true, false) + \"!\" + info.key;\n    });\n}\nfunction encrypt(data) {\n    return __awaiter(this, void 0, Promise, function* () {\n        //const iv:number[] = sjcl.random.randomWords(4, 0);\n        //sjcl.arrayBuffer.ccm.encrypt(new sjcl.cipher.aes(key), data, iv);\n        //crypto.subtle.encrypt({name: \"AES-CBC\", iv: iv}, key, new Uint8Array(data));\n        const key = yield crypto.subtle.generateKey({ name: 'AES-CBC', length: 128 }, true, [\"encrypt\"]);\n        const iv = new Uint8Array(16);\n        // crypto.getRandomValues(iv);\n        // not necessary because every key is only used once\n        const key_arr = yield crypto.subtle.exportKey(\"raw\", key);\n        console.log(key_arr.byteLength);\n        return {\n            data: new Uint8Array(yield crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, key, data)),\n            key: base64.encode(key_arr, true, false),\n            key_arr,\n            iv: iv\n        };\n    });\n}\nfunction decrypt(data, key_str, iv) {\n    return __awaiter(this, void 0, Promise, function* () {\n        const key = yield crypto.subtle.importKey(\"raw\", new Uint8Array(base64.decode(key_str, true)), \"AES-CBC\", false, [\"decrypt\"]);\n        return yield crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, key, data);\n    });\n}\nfunction uploadEncrypted(inputData) {\n    return __awaiter(this, void 0, Promise, function* () {\n        const filename = base64.encode(crypto.getRandomValues(new Uint8Array(16)).buffer, true, false);\n        const { key, iv, data } = yield encrypt(inputData);\n        return { key, iv, sha: yield repo.pushFileToMaster(filename, data) };\n    });\n}\nfunction displayImage(data) {\n    const img = document.createElement(\"img\");\n    const magic = new Uint16Array(data, 0, 1)[0];\n    const file = new Blob([data], { type: (magic == 0xFFD8 ? 'image/jpeg' : 'image/png') });\n    const url = URL.createObjectURL(file);\n    img.src = url;\n    document.body.innerHTML = \"\";\n    document.body.appendChild(img);\n}\nfunction download(sha, key) {\n    return __awaiter(this, void 0, Promise, function* () {\n        sha = arrToHex(new Uint8Array(base64.decode(sha)));\n        displayImage(yield decrypt(new Uint8Array(yield repo.getBlob(sha)), key, new Uint8Array(16)));\n    });\n}\nif (location.hash) {\n    if (location.hash.startsWith(\"#allowupload!\")) {\n        const [, crypt, key] = location.hash.substr(1).split(\"!\");\n        decrypt(new Uint8Array(base64.decode(crypt, true)), key, new Uint8Array(16)).then(token => {\n            localStorage.setItem(\"accessToken\", arrToHex(new Uint8Array(token)));\n            location.hash = \"\";\n            location.reload();\n        });\n    }\n    else {\n        const [filename, key] = location.hash.substr(1).split(\"!\");\n        document.writeln(\"Loading...<!--\");\n        download(filename, key);\n    }\n}\nelse if (repo.access_token) {\n    document.addEventListener('DOMContentLoaded', () => {\n        document.getElementById(\"fileinput\").addEventListener('change', uploadFile, false);\n    });\n}\nelse {\n    document.writeln(\"No image given and upload key missing<!--\");\n}\nfunction hexToArr(hex) {\n    const out = new Uint8Array(hex.length / 2);\n    for (let i = 0; i < hex.length; i += 2) {\n        out[i / 2] = parseInt(hex.substr(i, 2), 16);\n    }\n    return out;\n}\nfunction arrToHex(arr) {\n    let out = \"\";\n    for (const byte of arr)\n        out += (byte < 16 ? \"0\" + byte.toString(16) : byte.toString(16));\n    return out;\n}\nfunction uploadFile(evt) {\n    return __awaiter(this, void 0, Promise, function* () {\n        try {\n            document.body.textContent = \"Uploading...\";\n            const f = evt.target.files[0];\n            if (f) {\n                const data = new Uint8Array(yield readFile(f));\n                const info = yield uploadEncrypted(data);\n                const sha = base64.encode(hexToArr(info.sha).buffer, true, false);\n                history.replaceState({}, \"\", \"#\" + sha + \"!\" + info.key);\n                displayImage(data.buffer);\n            }\n        }\n        catch (e) {\n            document.body.textContent = JSON.stringify(e);\n            throw e;\n        }\n    });\n}\nfunction readFile(f) {\n    return __awaiter(this, void 0, Promise, function* () {\n        return new Promise((resolve, reject) => {\n            const r = new FileReader();\n            r.onload = e => resolve(r.result);\n            r.readAsArrayBuffer(f);\n        });\n    });\n}\n//# sourceMappingURL=tmp.js.map",null]}